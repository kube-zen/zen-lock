# Copyright 2025 Kube-ZEN Contributors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Default values for zen-lock
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1

image:
  repository: kubezen/zen-lock
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: "0.0.1-alpha"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""


# Controller configuration
controller:
  # Enable the controller component
  enabled: true
  # Number of controller replicas (defaults to replicaCount if not set)
  replicaCount: 1
  serviceAccount:
    create: true
    name: ""
    annotations: {}

podAnnotations: {}

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 65534
  fsGroup: 65534
  seccompProfile:
    type: RuntimeDefault

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true

service:
  type: ClusterIP
  port: 8080
  webhookPort: 443
  targetPort: 8080
  webhookTargetPort: 9443

resources:
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 128Mi

nodeSelector: {}

tolerations: []

affinity: {}

# Leader election configuration
leaderElection:
  enabled: false
  namespace: ""

# Webhook configuration
webhook:
  enabled: true
  port: 9443
  certDir: /tmp/k8s-webhook-server/serving-certs
  # Certificate secret name (managed by cert-manager if using webhook.certManager)
  certSecret: zen-lock-webhook-cert
  # Use cert-manager to manage certificates
  certManager:
    enabled: false
    issuer:
      name: ""
      kind: ClusterIssuer  # ClusterIssuer or Issuer
  # Webhook timeout in seconds (default: 10)
  timeoutSeconds: 10
  # Webhook failure policy: Fail or Ignore (default: Fail)
  # Fail: Reject the request if webhook fails
  # Ignore: Allow the request to proceed if webhook fails
  failurePolicy: Fail

# Private key configuration
# IMPORTANT: The private key must be provided via a Kubernetes Secret
# The secret must contain the key specified in privateKey.secretKey
privateKey:
  # Name of the secret containing the private key
  secretName: zen-lock-master-key
  # Key within the secret that contains the private key
  secretKey: key.txt
  # Create a placeholder secret (user must update it with actual key)
  createPlaceholder: true

# Metrics configuration
metrics:
  enabled: true
  port: 8080
  serviceMonitor:
    enabled: false
    interval: 30s
    scrapeTimeout: 10s
    labels: {}

# Prometheus rules
prometheus:
  rules:
    enabled: false

# Grafana dashboard
grafana:
  dashboard:
    enabled: false

# CRD management
crd:
  # Install CRDs as part of Helm install
  install: true

# Namespace configuration
namespace:
  create: true
  name: zen-lock-system

# Additional environment variables
env: []
  # - name: CUSTOM_VAR
  #   value: "custom-value"

# Additional volume mounts
extraVolumeMounts: []

# Additional volumes
extraVolumes: []

# Liveness and readiness probes
livenessProbe:
  httpGet:
    path: /healthz
    port: 8081
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /readyz
    port: 8081
  initialDelaySeconds: 5
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3

